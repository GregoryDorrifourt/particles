/********************************************************/
/* Author: Gregory Dorrifourt                           */
/* https://www.gregorydorrifourt.fr                     */
/* License: MIT                                         */
/* Repo: https://github.com/GregoryDorrifourt/particles */
/********************************************************/

class Particles{constructor(t={}){this.defaultConfig={element:"particles-background",contain:!1,threshold:150,particlesForScreenWidths:{small:90,medium:100,large:150},fullscreen:!1,addParticleOnClick:!1,color:"#404040",bubble:!0},this.config={...this.defaultConfig,...t},this.stopped=!1}render(){const t=window.requestAnimationFrame,i=document.getElementById(this.config.element),e=navigator.userAgent.match(/(iPad)|(iPhone)|(iPod)|(android)|(webOS)/i);let s=null;const h=i.getContext("2d");if(this.config.fullscreen){let t=window.innerWidth,i=window.innerHeight;h.canvas.width=t,h.canvas.height=i,window.addEventListener("resize",()=>{t=window.innerWidth,i=window.innerHeight,h.canvas.width=t,h.canvas.height=i})}const n=this.convertHexToRgb(this.config.color),a=this.config.threshold;let o=this.config.particlesForScreenWidths.small;window.matchMedia("(min-width: 481px)").matches&&this.config.particlesForScreenWidths.medium&&(o=this.config.particlesForScreenWidths.medium),window.matchMedia("(min-width: 1025px)").matches&&this.config.particlesForScreenWidths.large&&(o=this.config.particlesForScreenWidths.large);const c=[];for(let t=0;t<o;t++)c.push(new Particle(i,this.config));e||(document.addEventListener("mousemove",t=>{s={x:t.clientX,y:t.clientY}}),document.addEventListener("mouseleave",()=>{s=null}),this.config.addParticleOnClick&&document.addEventListener("click",()=>{c.length<o+50&&c.push(new Particle(i,this.config,s))}));const r=()=>{if(!document.hidden&&!this.stopped){h.clearRect(0,0,h.canvas.width,h.canvas.height);for(let t=0;t<c.length;t++){const i=c[t],o=(t,e,s)=>{const o=1-Math.max(e,s)/a;h.beginPath(),h.lineWidth=.2,h.strokeStyle=`rgba(${n.r},${n.g},${n.b},${o})`,h.moveTo(i.x,i.y),h.lineTo(t.x,t.y),h.stroke()};c.forEach(t=>{const e=Math.abs(t.x-i.x);if(e<a){const s=Math.abs(t.y-i.y);s<a&&o(t,e,s)}});let r=i.size;if(this.config.bubble&&!e&&s){const t=a||150,e=Math.abs(s.x-i.x);if(e<t){const h=Math.abs(s.y-i.y);h<t&&(a&&o(s,e,h),r+=(t-Math.max(e,h))/5)}}const l=i.size/10;h.fillStyle=`rgba(${n.r},${n.g},${n.b},${l})`,h.beginPath(),h.arc(i.x,i.y,r,2*Math.PI,!1),h.fill(),i.move()}}t(r)};r()}convertHexToRgb(t){const i=t.replace("#","").match(/.{1,2}/g);return{r:parseInt(i[0],16),g:parseInt(i[1],16),b:parseInt(i[2],16)}}stop(){this.stopped=!0}resume(){this.stopped=!1}}class Particle{constructor(t,i,e=null){this.maxPx=30,this.canvas=t,this.coordinates=e,t&&!e?(this.ch=Math.max(t.height,i.contain?0:800),this.cw=Math.max(t.width,i.contain?0:1e3),this.x=Math.random()*this.cw,this.y=Math.random()*this.ch):(this.x=e.x,this.y=e.y),this.setSize(),this.setVelocity()}setSize(){this.size&&6!==this.size||(this.size=Math.floor(3*Math.random())+2)}setVelocity(){this.vx=(Math.floor(10*Math.random())-5)/10,this.vy=(Math.floor(10*Math.random())-5)/10}move(){this.gpId=null,this.vx&&this.vy||this.setVelocity(),this.x+=this.vx,this.y+=this.vy,this.canvas&&(this.y>this.ch+20&&(this.y=-10,this.x=Math.random()*this.cw),this.y<-20&&(this.y=this.ch+10,this.x=Math.random()*this.cw),this.x>this.cw+20&&(this.y=Math.random()*this.ch,this.x=-10),this.x<-20&&(this.y=Math.random()*this.ch,this.x=this.cw+10))}}